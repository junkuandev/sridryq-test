{{ 'featured-product-split.css' | asset_url | stylesheet_tag }}
{{ 'featured-product-split.js' | asset_url | script_tag }}
<section class="featured-product-split fps-{{ section.id }} page-width pp">
  {% assign product = all_products[section.settings.product] %}
  {% if product %}
    <!-- === TOP ROW === -->
    <div class="fps__row fps__row--top">
      <!-- TEXT COLUMN -->
      <div class="fps__col fps__text">
        <div class="fps__text-grid">
          <h2 class="product__title">{{ product.title | escape }}</h2>
          <div class="product__trust-badge">
            <img src="{{ 'trust-badge.png' | asset_url }}" alt="Trust badge" loading="lazy">
          </div>
        </div>

        {% if section.settings.section_heading %}
          <span class="fps__intro">{{ section.settings.section_heading }}</span>
        {% endif %}

        <div class="fps__desc rte">
          {% if section.settings.use_product_description %}
            {{ product.description }}
          {% else %}
            {% for block in section.blocks %}
              {% if block.type == 'desc_item' %}
                <div class="fps__desc-row">
                  {% assign icon = block.settings.icon %}
                  {% if icon %}
                    <img class="fps__desc-icon" src="{{ icon | image_url: width: 24 }}" alt="">
                  {% else %}
                    <span class="fps__desc-icon">âœ”</span>
                  {% endif %}
                  <span class="fps__desc-text">{{ block.settings.text }}</span>
                </div>
              {% endif %}
            {% endfor %}
          {% endif %}
        </div>
      </div>

      <!-- MEDIA COLUMN -->
      {% if product.images.size > 0 %}
        <div class="fps__col fps__media">
          <div class="fps-carousel">
            <div class="fps-carousel__main">
              <div class="fps-carousel__controls">
                <button class="fps-carousel__arrow fps-carousel__arrow--prev" aria-label="Previous image">
                  &#10094;
                </button>
                <button class="fps-carousel__arrow fps-carousel__arrow--next" aria-label="Next image">&#10095;</button>
              </div>

              <img
                id="fps-main-image-{{ section.id }}"
                src="{{ product.featured_image | image_url: width: 800 }}"
                alt="{{ product.title }}"
                class="fps-carousel__image"
                loading="lazy"
              >
            </div>
            <div class="fps-carousel__thumbnails">
              {% for image in product.images %}
                <img
                  src="{{ image | image_url: width: 150 }}"
                  alt="{{ product.title }} thumbnail {{ forloop.index }}"
                  class="fps-carousel__thumbnail{% if forloop.first %} is-active{% endif %}"
                  data-large="{{ image | image_url: width: 800 }}"
                >
              {% endfor %}
            </div>
          </div>
        </div>
      {% endif %}
    </div>

    <!-- === BOTTOM ROW === -->
    <div class="fps__row fps__row--bottom">
      <div class="fps__col fps__price">
        {% if section.settings.promo_text %}
          <p class="fps__promo">{{ section.settings.promo_text }}</p>
        {% endif %}
        <div class="fps__pricing">
          {% if product.compare_at_price > product.price %}
            <span class="fps__price--compare">{{ product.compare_at_price | money }}</span>
          {% endif %}
          <span class="fps__price--current">{{ product.price | money }}</span>
        </div>

        <form method="post" action="/cart/add" class="fps__form">
          <input type="hidden" name="id" value="{{ product.selected_or_first_available_variant.id }}">
          <button type="submit" class="button button--primary">
            {{ section.settings.button_label | default: 'Order Now' }}
          </button>
        </form>
      </div>

      <div class="fps__col fps__icons">
        {% for block in section.blocks %}
          {% if block.type == 'icon' %}
            <div class="fps__icon">
              {% if block.settings.icon %}
                <img src="{{ block.settings.icon | image_url: width: 40 }}" alt="">
              {% endif %}
              <p>{{ block.settings.text }}</p>
            </div>
          {% endif %}
        {% endfor %}
      </div>
    </div>
  {% else %}
    <p>No product selected.</p>
  {% endif %}
</section>

{% schema %}
{
  "name": "Featured Product Split",
  "settings": [
    {
      "type": "product",
      "id": "product",
      "label": "Select product"
    },
    {
      "type": "richtext",
      "id": "section_heading",
      "label": "Section heading (intro paragraph)"
    },
    {
      "type": "checkbox",
      "id": "use_product_description",
      "label": "Use product description instead of custom items",
      "default": true
    },
    {
      "type": "html",
      "id": "promo_text",
      "label": "Promo text"
    },
    {
      "type": "text",
      "id": "button_label",
      "label": "Button label",
      "default": "Order Now"
    }
  ],
  "blocks": [
    {
      "type": "desc_item",
      "name": "Description item",
      "settings": [
        {
          "type": "image_picker",
          "id": "icon",
          "label": "Icon (optional)"
        },
        {
          "type": "text",
          "id": "text",
          "label": "Description text"
        }
      ]
    },
    {
      "type": "icon",
      "name": "Icon feature (bottom row)",
      "settings": [
        {
          "type": "image_picker",
          "id": "icon",
          "label": "Icon"
        },
        {
          "type": "text",
          "id": "text",
          "label": "Text"
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "Featured Product Split"
    }
  ]
}
{% endschema %}
